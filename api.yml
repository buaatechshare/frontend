swagger: "2.0"

info:
  description: "the api document for BUAA techshare platform"
  version: "1.0.0"
  title: "techshare API"
  termsOfService: "http://swagger.io/terms/"
# host: "http://rap2api.taobao.org/app/mock/161835/"
basePath: "/"
schemes:
- "http"
paths:
  /comment:
    post:
      summary: post comment and rate with userID and resourceID
      description: the comment has only one level combinded with a certain resource
      parameters:
        - name: userID
          description: userID
          in: query
          required: true
          type: string
        - name: resourceID
          description: resourceID
          in: query
          required: true
          type: string
        - name: comment
          description: comment
          in: query
          required: true
          type: string
        - name: rate
          description: rate 5 maximum
          in: query
          required: true
          type: number
          format: flaot
      responses:
        200:
          description: finished
    get:
      summary: get comment with the resourceID
      description: get comment with the resourceID
      parameters:
        - name: resourceID
          description: resourceID
          in: query
          required: true
          type: string
        - $ref: '#/parameters/pageNumber'
        - $ref: '#/parameters/pageSize'
      responses:
        200: 
          description: finished
          schema:
            $ref: '#/definitions/commentlist'

  /myPaper/{userID}:
    get:
      summary: 在专家资源管理界面得到专家自己的paper
      description: 在专家资源管理界面得到专家自己的paper
      parameters: 
        - $ref: '#/paremeters/userID'
      responses:
        200: 
          description: finished
          schema:
            $ref: '#/definitions/paperlist'
    post:
      summary: 提交自己的专家论文
      description: 提交自己的论文，包括信息和pdf
      parameters:
        - $ref: '#/paremeters/userID'
      responses:
        200:
          description: finished
        
  /login:
    post:
      summary: login with email and password
      description: login with email and password
      parameters: 
        - name: username
          description: this parameter should be named as "username"
          in: query
          type: "string"
          format: email
        - name: password
          in: query
          type: string
          format: password
      responses:
        200: 
          description: finished
        404:
          description: not found
  /register:
    post:
      summary: register and post a new user
      parameters:
        - name: email
          in: query
          type: "string"
          format: email
        - name: userName
          in: query
          type: "string"
        - name: phoneNumber
          in: query
          type: "string"
        - name: password
          in: query
          type: string
          format: password
      responses:
        201:
          description: register successfully
        500:
          description: fail to register
  /papers:
    get:
      summary: get the default recommended papers
      parameters:
        - $ref: '#/parameters/pageNumber'
        - $ref: '#/parameters/pageSize'
      responses:
        200:
          description: a list of papers
          schema:
            $ref: '#/definitions/paperlist'
        404:
          description: the papers has not been found
          
  /papers/{userID}:
    get:
      summary: get the recommended papers for a certain user
      parameters:
        - $ref: '#/parameters/pageNumber'
        - $ref: '#/parameters/pageSize'
        - $ref: '#/parameters/userID'
      responses:
        200:
          description: a list of paper for a certain user
          schema:
            $ref: '#/definitions/paperlist'
    
  /patents:
    get:
      summary: get the default recommended patents
      parameters:
        - $ref: '#/parameters/pageNumber'
        - $ref: '#/parameters/pageSize'
      responses:
        200:
          description: a list of patents
          schema:
            $ref: '#/definitions/patentlist'
        404:
          description: the patents have not been found
          
  /patents/{userID}:
    get:
      summary: get a list patents for a certain user
      parameters:
        - $ref: '#/parameters/pageNumber'
        - $ref: '#/parameters/pageSize'
        - $ref: '#/parameters/userID'
      responses:
        200:
          description: a list of patents for a certain user
          schema:
            $ref: '#/definitions/patentlist'
  #TODO 搜索确定界面之后确定
  /search/papers:
    get:
      description: get searched result
      summary: get searched result
      parameters:
        - name: keywords
          in: query
          type: "string"
          description: the searching information and keywords
      responses:
        200:
          description: a list of papers
          schema:
            $ref: '#/definitions/paperlist'
        404:
          description: not found
  /search/patents:
    get:
      description: get searched result
      summary: get searched result
      parameters: 
       - name: keywords
         in: query
         type: "string"
         description: searching information
      responses:
        200:
          description: a list of patents
          schema:
            $ref: '#/definitions/patentlist'
        404:
          description: not found
  /search/professors:
    get:
      description: get searched professors
      summary: get searched professors
      parameters:
        - name: keywords
          in: query
          type: "string"
          description: searching information
      responses:
        200:
          description: a list of professors
          schema:
            $ref: '#/definitions/professorlist'

  /paperDetail/{resourceID}:
    get:
      description: get paper detail
      summary: get paper detail
      parameters:
        - name: resourceID
          in: path
          required: true
          type: "string"
      responses:
        200:
          description: the full details for a paper
          schema:
            required:
              - author
              - paperName
              - abstract
            properties:
              DOI:
                type: "string"
              docType:
                type: string
              paperTitle:
                type: string
              originalTitle:
                type: string
              bookTitle:
                type: string
              year:
                type: number
              date:
                type: string
                format: datetime
              publisher:
                type: string
              journal:
                type: string
              conference:
                type: string
              volume:
                type: string
              issue:
                type: string
              firstPage:
                type: string
              lastPage:
                type: string
              referenceCount:
                type: number
              citationCount:
                type: number
              resourceURL:
                type: string
                format: url
                
  /patentDetail/{resourceID}:
    get:
      description:  get patent detail
      summary: get patent detail
      parameters: 
        - name: resourceID
          description: resourceID
          in: path
          required: true
          type: integer
      responses:
        200:
          description: get detail succesfully
          schema:
            properties:
              primaryClass:
                type: string
              ApplicationNumber:
                type: number
              title:
                type: string
              country_province:
                type: string
              publicationDate:
                type: string
                format: datetime
              authorizedAnnouncementDate:
                type: string
                format: datetime
              applicationAddress:
                type: string
              currentRightHolder:
                type: string
              assignee:
                type: number
              keywords:
                type: array
                items:
                  type: string
              filingDate:
                type: string
                format: datetime
              publicationNumber:
                type: number
              authorizedPublicNumber:
                type: number
              applicant:
                type: string
              inventors:
                type: array
                items:
                  type: string
              agent:
                type: array
                items: 
                  type: string
              priority:
                type: string
              currentState:
                type: boolean
              summary:
                type: string
                format: text
  #TODO 关于多级interest的问题
  /interests:
    get:
      summary: get all interest tags from backend
      description: get all interest tags from backend
      responses:
        200:
          description: OK
          schema:
            properties:
              tags:
                type: array
                items:
                  type: string
  
  /userinfo/{userID}:
    get:
      summary: get user infomation
      description: get user infomation including email, username, email and password
      parameters: 
        - $ref: '#/parameters/userID'
      responses:
        200:
          description: OK
          schema:
            $ref: '#/definitions/userInfo'
        404:
          description: the user not found
    patch:
      summary: update user information
      description: update all information of user
      parameters: 
        - $ref: '#/parameters/userID'
        - name: password
          in: query
          type: string
          format: password
        - name: username
          in: query
          type: string
      responses:
        200:
          description: OK
        404: 
          description: the user not found
  /collections/{userID}:
    post:
      description: 上传新的收藏
      parameters:
        - $ref: '#/parameters/userID'
        - name: resourceID
          in: query
          required: true
          type: string
      responses:
        201:
          description: post successfully
        404:
          description: the user not found
    delete:
      description: delete a collection of paper
      parameters:
      - $ref: '#/parameters/userID'
      - name: resourceID
        in: query
        required: true
        type: string
      responses:
        204:
          description: delete successfully
        404:
          description: user or resource not found
  /collections/papers/{userID}:
    get:
      description: 得到用户收藏的paper，给定pagesize，不给定pagenumber，自动分页，传回
      parameters:
        - $ref: '#/parameters/userID'   
        - $ref: '#/parameters/pageSize' 
      responses:
        200: 
          description: OK
          schema: 
            $ref: '#/definitions/paperlist'
        404:
          description: the user not found
  
  /collections/patents/{userID}:
    get:
      description: 得到用户收藏的专利，给定pagesize，不给定pagenumber，自动分页，传回
      parameters:
        - $ref: '#/parameters/userID'    
        - $ref: '#/parameters/pageSize'
      responses:
        200: 
          description: OK
          schema: 
            $ref: '#/definitions/patentlist'
        404:
          description: the user not found

  /messages:
    get:
      description: 给定receiver时，传回所有接收的信，给定sender，传回所有发出的信，两个都给定时，传回符合的信
      parameters:
        - name: receiverID
          in: query
          type: number
        - name: senderID
          in: query
          type: number
      responses:
        200:
          description: OK
          schema:
            $ref: '#/definitions/messagelist'
        404:
          description: user or message not found
    post:
      description: post a message 
      parameters:
        - name: receiverID
          in: query
          required: true
          type: number
        - name: sender
          in: query
          required: true
          type: number
        - name: content
          in: query
          type: string
          format: text
      responses:
        201:
          description: add the new message successfully
        400:
          description: fail to add the new message
  
  /follow/{userID}:
    get:
      description: get the proflist the user follows
      summary: get the proflist the user follows
      parameters:
        - $ref: '#/parameters/userID'
      responses:
        200:
          description: OK
          schema:
            $ref: '#/definitions/professorlist'
        400:
          description: invalid request
        404:
          description: not found
    post:
      description: post a new prof followed by the user
      summary: psot a new prof followed by the user
      parameters:
        - $ref: '#/parameters/userID'
        - name: professor
          in: query
          required: true
          type: number
      responses:
        201: 
          description: created
        400:
          description: invalid request
        404:
          description: user not found
    delete:
      description: unfollow the professor
      summary: unfollow the professor
      parameters:
        - $ref: '#/parameters/userID'
        - name: professor
          in: query
          required: true
          type: string
          format: email
      responses:
        201:
          description: deleted
        400:
          description: invalid request
        404: 
          description: the follower or professor not found

  /application/{userID}:
    post:
      description: post the application to be professor
      parameters:
        - $ref: '#/parameters/userID'
        - name: introduction
          in: query
          required: true
          type: string
          format: text
        - name: constitution
          in: query
          required: true
          type: string
        - name: Name
          in: query
          required: true
          type: string
        - name: Field
          in: query
          required: true
          type: array
          items: 
            type: string
      responses:
        201:
          description: created
        400:
          description: invalid
        404:
          description: user not found
    get:
      description: get the application using userID
      parameters:
        - $ref: '#/parameters/userID'
      responses:
        201:
          description: get successfully
          schema:
            required:
              - datetime
              - introduction
              - constitution
              - Name
            properties:
              datetime:
                type: string
                format: datetime
              introduction:
                type: string
                format: text
              constitution:
                type: string
              Name:
                type: string
              isPass:
                type: boolean
              reason:
                type: string
                format: text
          
  #TODO: 学术管理接口

# test    
parameters:
  userID:
    name: userID
    in: path
    required: true
    type: number
  pageNumber:
    name: pageNumber
    in: query
    required: true
    type: number
  pageSize:
    name: pageSize
    required: true
    in: query
    type: number
definitions:
  userInfo:
    type: object
    properties:
      email:
        type: "string"
        format: email
      password:
        type: string
        format: password
      username:
        type: string
  paper:
    type: object
    required:
      - author
      - paperName
    properties:
      author:
        type: "string"
      paperName:
        type: "string"
      abstract:
        type: string
        format: text
  patent:
    type: object
    required:
      - rightHolder
      - patentName
    properties:
      rightHolder:
        type: "string"
      patentName:
        type: "string"
      summary:
        type: string
        format: text
  professor:
    type: object
    required:
      - name
      - field
    properties:
      name:
        type: "string"
      field:
        type: "string"
      constitution:
        type: "string"
  message:
    type: object
    required:
      - receiverName
      - senderName
      - content
    properties:
      receiverName:
        type: string
      senderName:
        type: string
      content:
        type: string
        format: text
  comment:
    type: object
    required:
      - name
      - content
    properties:
      name:
        type: string
      content:
        type: string
        format: text

  paperlist:
    type: array
    items:
      $ref: '#/definitions/paper'

  patentlist:
    type: array
    items:
      $ref: '#/definitions/patent'

  professorlist:
    type: array
    items:
      $ref: '#/definitions/professor'
  messagelist:
    type: array
    items:
      $ref: '#/definitions/message'
  commentlist:
    type: array
    items:
      $ref: '#/definitions/comment'
